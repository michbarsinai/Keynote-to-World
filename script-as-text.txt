-- Get folder path of fileon getFolderPath(p_strFullPath)	do shell script "dirname " & quoted form of p_strFullPathend getFolderPath-- Get basename of file with no file extension, independent of default shellon getBaseName(p_strFullPath)	do shell script "basename " & quoted form of p_strFullPath & " | sed -E 's/\\.[^.]*$//'"end getBaseName-- Export to PDF in same folder with same file nameon exportPDF(p_strFullPath)	set strOutputFilePath to getFolderPath(p_strFullPath) & "/" & getBaseName(p_strFullPath) & ".pdf"	tell application "Keynote"		set objKeynoteFile to open (p_strFullPath as POSIX file)		export objKeynoteFile to (strOutputFilePath as POSIX file) as PDF with properties {all stages:true}		close objKeynoteFile saving no	end tellend exportPDF-- Export to PowerPoint in same folder with same file nameon exportPowerPoint(p_strFullPath)	set strOutputFilePath to getFolderPath(p_strFullPath) & "/" & getBaseName(p_strFullPath) & ".pptx"	tell application "Keynote"		set objKeynoteFile to open (p_strFullPath as POSIX file)		export objKeynoteFile to (strOutputFilePath as POSIX file) as Microsoft PowerPoint		close objKeynoteFile saving no	end tellend exportPowerPoint-- ExamplesexportPDF("path/to/sample.key")exportPowerPoint("path/to/sample.key")on open theDroppedItems	repeat with a from 1 to length of theDroppedItems		set theCurrentDroppedItem to item a of theDroppedItems		set asString to POSIX path of theCurrentDroppedItem		exportPDF(asString)		exportPowerPoint(asString)	end repeatend open